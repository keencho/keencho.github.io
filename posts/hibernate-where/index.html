<!DOCTYPE html><html lang="ko-KS" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Hibernate @Where" /><meta name="author" content="keencho" /><meta property="og:locale" content="ko_KS" /><meta name="description" content="Hibernate @Where" /><meta property="og:description" content="Hibernate @Where" /><link rel="canonical" href="https://keencho.github.io/posts/hibernate-where/" /><meta property="og:url" content="https://keencho.github.io/posts/hibernate-where/" /><meta property="og:site_name" content="keencho’s blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-26T08:12:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hibernate @Where" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@keencho" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"keencho"},"dateModified":"2022-06-16T10:52:48+09:00","datePublished":"2022-05-26T08:12:00+09:00","description":"Hibernate @Where","headline":"Hibernate @Where","mainEntityOfPage":{"@type":"WebPage","@id":"https://keencho.github.io/posts/hibernate-where/"},"url":"https://keencho.github.io/posts/hibernate-where/"}</script><title>Hibernate @Where | keencho's blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="keencho's blog"><meta name="application-name" content="keencho's blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/custom/keencho.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">keencho's blog</a></div><div class="site-subtitle font-italic">이것저것 정리하는 블로그.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/keencho" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['seyoung050412','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hibernate @Where</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Hibernate @Where</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1653520320" data-df="ll" data-toggle="tooltip" data-placement="bottom"> May 26, 2022 </em> </span><div class="d-flex justify-content-between"> <span> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1360 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><h1 id="hibernate-where">Hibernate @Where</h1><h3 id="where-란"><span class="mr-2">@Where 란?</span><a href="#where-란" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>떄때로 커스텀한 SQL을 이용해 엔티티 혹은 컬렉션을 필터링하고 싶은 경우가 있습니다. 이 경우 Hibernate 에서 제공하는 어노테이션중 <code class="language-plaintext highlighter-rouge">@Where</code> 이라는 어노테이션을 사용해 쉽게 필터링 할 수 있습니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nd">@Target</span><span class="o">({</span><span class="no">TYPE</span><span class="o">,</span> <span class="no">METHOD</span><span class="o">,</span> <span class="no">FIELD</span><span class="o">})</span>
<span class="nd">@Retention</span><span class="o">(</span><span class="no">RUNTIME</span><span class="o">)</span>
<span class="kd">public</span> <span class="nd">@interface</span> <span class="nc">Where</span> <span class="o">{</span>
	<span class="nc">String</span> <span class="nf">clause</span><span class="o">();</span>
<span class="o">}</span>
</pre></table></code></div></div><p>어노테이션 자체도 간단합니다. where 절을 clause 멤버변수에 작성하라고 안내하고 있습니다.</p><h3 id="entity에-적용하기"><span class="mr-2">Entity에 적용하기</span><a href="#entity에-적용하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>간단한 예제 엔티티를 작성해 보겠습니다. 부모 엔티티 (MainOrder)와 자식 엔티티(SubOrder)가 존재하며, 양방향으로 매핑을 해주도록 하겠습니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="nd">@Entity</span>
<span class="nd">@Data</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@ToString</span><span class="o">(</span><span class="n">exclude</span> <span class="o">=</span> <span class="o">{</span><span class="s">"activeSubOrderList"</span><span class="o">,</span> <span class="s">"deActivatedSubOrderList"</span><span class="o">,</span> <span class="s">"fromNameLikeCList"</span><span class="o">})</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"main_order"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainOrder</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">AUTO</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">LocalDate</span> <span class="n">orderDate</span> <span class="o">=</span> <span class="nc">LocalDate</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>

    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"mainOrder"</span><span class="o">,</span> <span class="n">cascade</span> <span class="o">=</span> <span class="nc">CascadeType</span><span class="o">.</span><span class="na">ALL</span><span class="o">,</span> <span class="n">orphanRemoval</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span>
    <span class="nd">@Where</span><span class="o">(</span><span class="n">clause</span> <span class="o">=</span> <span class="s">"active = true"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">SubOrder</span><span class="o">&gt;</span> <span class="n">activeSubOrderList</span><span class="o">;</span>

    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"mainOrder"</span><span class="o">,</span> <span class="n">cascade</span> <span class="o">=</span> <span class="nc">CascadeType</span><span class="o">.</span><span class="na">ALL</span><span class="o">,</span> <span class="n">orphanRemoval</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span>
    <span class="nd">@Where</span><span class="o">(</span><span class="n">clause</span> <span class="o">=</span> <span class="s">"active = false"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">SubOrder</span><span class="o">&gt;</span> <span class="n">deActivatedSubOrderList</span><span class="o">;</span>

    <span class="nd">@OneToMany</span><span class="o">(</span><span class="n">mappedBy</span> <span class="o">=</span> <span class="s">"mainOrder"</span><span class="o">,</span> <span class="n">cascade</span> <span class="o">=</span> <span class="nc">CascadeType</span><span class="o">.</span><span class="na">ALL</span><span class="o">,</span> <span class="n">orphanRemoval</span> <span class="o">=</span> <span class="kc">true</span><span class="o">,</span> <span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span>
    <span class="nd">@Where</span><span class="o">(</span><span class="n">clause</span> <span class="o">=</span> <span class="s">"LOWER(from_name) LIKE 'c%'"</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">List</span><span class="o">&lt;</span><span class="nc">SubOrder</span><span class="o">&gt;</span> <span class="n">fromNameLikeCList</span><span class="o">;</span>

<span class="o">}</span>
</pre></table></code></div></div><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="nd">@Entity</span>
<span class="nd">@Data</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"sub_order"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SubOrder</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">AUTO</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">fromName</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">fromPhoneNumber</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">fromAddress</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">toName</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">toPhoneNumber</span><span class="o">;</span>
    <span class="kd">private</span> <span class="nc">String</span> <span class="n">toAddress</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span><span class="o">(</span><span class="n">optional</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">MainOrder</span> <span class="n">mainOrder</span><span class="o">;</span>

    <span class="kd">private</span> <span class="kt">boolean</span> <span class="n">active</span><span class="o">;</span>

<span class="o">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">@Where</code> 어노테이션을 통해 각각의 조건에 부합하는 자식 엔티티 리스트를 가져올수 있도록 하였습니다.</p><blockquote><p><code class="language-plaintext highlighter-rouge">@Where</code> 어노테이션의 sql 문의 필드명은 데이터베이스의 필드명이어야 합니다. <br /> 예를들어 위 MainOrder 엔티티의 fromNameLikeCList 의 경우 “LOWER(fromName) LIKE ‘c%’” 라고 작성하면 에러가 발생합니다.</p></blockquote><h3 id="조회-결과-확인하기"><span class="mr-2">조회 결과 확인하기</span><a href="#조회-결과-확인하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>엔티티 객체를 작성하였으니 이제 더미데이터를 넣고 테스트를 수행해보겠습니다. 더미데이터는 <a href="https://github.com/DiUS/java-faker">java-faker</a> 라이브러리를 사용하였습니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="kd">public</span> <span class="kt">void</span> <span class="nf">initData</span><span class="o">()</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="n">mainOrderList</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;</span><span class="nc">MainOrder</span><span class="o">&gt;();</span>

    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="o">;</span> <span class="n">i</span> <span class="o">++)</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="n">mainOrder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">MainOrder</span><span class="o">();</span>
        <span class="n">mainOrderList</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">mainOrderRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">mainOrder</span><span class="o">));</span>
    <span class="o">}</span>

    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="o">;</span> <span class="n">i</span> <span class="o">++)</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="n">subOrder</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SubOrder</span><span class="o">();</span>
        <span class="n">subOrder</span><span class="o">.</span><span class="na">setActive</span><span class="o">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">3</span> <span class="o">==</span> <span class="mi">0</span><span class="o">);</span>

        <span class="n">subOrder</span><span class="o">.</span><span class="na">setFromName</span><span class="o">(</span><span class="nc">JavaFakerGenerator</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">subOrder</span><span class="o">.</span><span class="na">setFromPhoneNumber</span><span class="o">(</span><span class="nc">JavaFakerGenerator</span><span class="o">.</span><span class="na">getPhoneNumber</span><span class="o">());</span>
        <span class="n">subOrder</span><span class="o">.</span><span class="na">setFromAddress</span><span class="o">(</span><span class="nc">JavaFakerGenerator</span><span class="o">.</span><span class="na">getAddress</span><span class="o">());</span>

        <span class="n">subOrder</span><span class="o">.</span><span class="na">setToName</span><span class="o">(</span><span class="nc">JavaFakerGenerator</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
        <span class="n">subOrder</span><span class="o">.</span><span class="na">setToPhoneNumber</span><span class="o">(</span><span class="nc">JavaFakerGenerator</span><span class="o">.</span><span class="na">getPhoneNumber</span><span class="o">());</span>
        <span class="n">subOrder</span><span class="o">.</span><span class="na">setToAddress</span><span class="o">(</span><span class="nc">JavaFakerGenerator</span><span class="o">.</span><span class="na">getAddress</span><span class="o">());</span>

        <span class="n">subOrder</span><span class="o">.</span><span class="na">setMainOrder</span><span class="o">(</span><span class="n">mainOrderList</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">5</span><span class="o">));</span>
        <span class="n">subOrderRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">subOrder</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>활성:비활성의 비율을 약 1:2 정도의 비율로 세팅하여 테스트 데이터를 생성하였습니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="nd">@Transactional</span>
<span class="kt">void</span> <span class="nf">whereAnnotationTest1</span><span class="o">()</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="n">mainOrderList</span> <span class="o">=</span> <span class="n">mainOrderRepository</span><span class="o">.</span><span class="na">findAll</span><span class="o">();</span>

    <span class="n">mainOrderList</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">mainOrder</span> <span class="o">-&gt;</span> <span class="o">{</span>
        <span class="n">mainOrder</span><span class="o">.</span><span class="na">getActiveSubOrderList</span><span class="o">();</span>
        <span class="n">mainOrder</span><span class="o">.</span><span class="na">getDeActivatedSubOrderList</span><span class="o">();</span>
        <span class="n">mainOrder</span><span class="o">.</span><span class="na">getFromNameLikeCList</span><span class="o">();</span>
    <span class="o">});</span>
<span class="o">}</span>
</pre></table></code></div></div><p>테스트 코드입니다. 테스트를 수행한다기 보다 쿼리를 확인할 목적으로 작성하였습니다.</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="k">select</span>
    <span class="n">activesubo0_</span><span class="p">.</span><span class="n">main_order_id</span> <span class="k">as</span> <span class="n">main_ord9_2_0_</span><span class="p">,</span>
    <span class="n">activesubo0_</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">id1_2_0_</span><span class="p">,</span>
    <span class="n">activesubo0_</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">id1_2_1_</span><span class="p">,</span>
    <span class="n">activesubo0_</span><span class="p">.</span><span class="n">active</span> <span class="k">as</span> <span class="n">active2_2_1_</span><span class="p">,</span>
    <span class="n">activesubo0_</span><span class="p">.</span><span class="n">from_address</span> <span class="k">as</span> <span class="n">from_add3_2_1_</span><span class="p">,</span>
    <span class="n">activesubo0_</span><span class="p">.</span><span class="n">from_name</span> <span class="k">as</span> <span class="n">from_nam4_2_1_</span><span class="p">,</span>
    <span class="n">activesubo0_</span><span class="p">.</span><span class="n">from_phone_number</span> <span class="k">as</span> <span class="n">from_pho5_2_1_</span><span class="p">,</span>
    <span class="n">activesubo0_</span><span class="p">.</span><span class="n">main_order_id</span> <span class="k">as</span> <span class="n">main_ord9_2_1_</span><span class="p">,</span>
    <span class="n">activesubo0_</span><span class="p">.</span><span class="n">to_address</span> <span class="k">as</span> <span class="n">to_addre6_2_1_</span><span class="p">,</span>
    <span class="n">activesubo0_</span><span class="p">.</span><span class="n">to_name</span> <span class="k">as</span> <span class="n">to_name7_2_1_</span><span class="p">,</span>
    <span class="n">activesubo0_</span><span class="p">.</span><span class="n">to_phone_number</span> <span class="k">as</span> <span class="n">to_phone8_2_1_</span> 
<span class="k">from</span>
    <span class="n">sub_order</span> <span class="n">activesubo0_</span> 
<span class="k">where</span>
    <span class="p">(</span>
        <span class="n">activesubo0_</span><span class="p">.</span><span class="n">active</span> <span class="o">=</span> <span class="k">true</span>
    <span class="p">)</span> 
    <span class="k">and</span> <span class="n">activesubo0_</span><span class="p">.</span><span class="n">main_order_id</span><span class="o">=</span><span class="mi">1</span>
</pre></table></code></div></div><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="k">select</span>
    <span class="n">deactivate0_</span><span class="p">.</span><span class="n">main_order_id</span> <span class="k">as</span> <span class="n">main_ord9_2_0_</span><span class="p">,</span>
    <span class="n">deactivate0_</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">id1_2_0_</span><span class="p">,</span>
    <span class="n">deactivate0_</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">id1_2_1_</span><span class="p">,</span>
    <span class="n">deactivate0_</span><span class="p">.</span><span class="n">active</span> <span class="k">as</span> <span class="n">active2_2_1_</span><span class="p">,</span>
    <span class="n">deactivate0_</span><span class="p">.</span><span class="n">from_address</span> <span class="k">as</span> <span class="n">from_add3_2_1_</span><span class="p">,</span>
    <span class="n">deactivate0_</span><span class="p">.</span><span class="n">from_name</span> <span class="k">as</span> <span class="n">from_nam4_2_1_</span><span class="p">,</span>
    <span class="n">deactivate0_</span><span class="p">.</span><span class="n">from_phone_number</span> <span class="k">as</span> <span class="n">from_pho5_2_1_</span><span class="p">,</span>
    <span class="n">deactivate0_</span><span class="p">.</span><span class="n">main_order_id</span> <span class="k">as</span> <span class="n">main_ord9_2_1_</span><span class="p">,</span>
    <span class="n">deactivate0_</span><span class="p">.</span><span class="n">to_address</span> <span class="k">as</span> <span class="n">to_addre6_2_1_</span><span class="p">,</span>
    <span class="n">deactivate0_</span><span class="p">.</span><span class="n">to_name</span> <span class="k">as</span> <span class="n">to_name7_2_1_</span><span class="p">,</span>
    <span class="n">deactivate0_</span><span class="p">.</span><span class="n">to_phone_number</span> <span class="k">as</span> <span class="n">to_phone8_2_1_</span> 
<span class="k">from</span>
    <span class="n">sub_order</span> <span class="n">deactivate0_</span> 
<span class="k">where</span>
    <span class="p">(</span>
        <span class="n">deactivate0_</span><span class="p">.</span><span class="n">active</span> <span class="o">=</span> <span class="k">false</span>
    <span class="p">)</span> 
    <span class="k">and</span> <span class="n">deactivate0_</span><span class="p">.</span><span class="n">main_order_id</span><span class="o">=</span><span class="mi">1</span>
</pre></table></code></div></div><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="k">select</span>
    <span class="n">fromnameli0_</span><span class="p">.</span><span class="n">main_order_id</span> <span class="k">as</span> <span class="n">main_ord9_2_0_</span><span class="p">,</span>
    <span class="n">fromnameli0_</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">id1_2_0_</span><span class="p">,</span>
    <span class="n">fromnameli0_</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">id1_2_1_</span><span class="p">,</span>
    <span class="n">fromnameli0_</span><span class="p">.</span><span class="n">active</span> <span class="k">as</span> <span class="n">active2_2_1_</span><span class="p">,</span>
    <span class="n">fromnameli0_</span><span class="p">.</span><span class="n">from_address</span> <span class="k">as</span> <span class="n">from_add3_2_1_</span><span class="p">,</span>
    <span class="n">fromnameli0_</span><span class="p">.</span><span class="n">from_name</span> <span class="k">as</span> <span class="n">from_nam4_2_1_</span><span class="p">,</span>
    <span class="n">fromnameli0_</span><span class="p">.</span><span class="n">from_phone_number</span> <span class="k">as</span> <span class="n">from_pho5_2_1_</span><span class="p">,</span>
    <span class="n">fromnameli0_</span><span class="p">.</span><span class="n">main_order_id</span> <span class="k">as</span> <span class="n">main_ord9_2_1_</span><span class="p">,</span>
    <span class="n">fromnameli0_</span><span class="p">.</span><span class="n">to_address</span> <span class="k">as</span> <span class="n">to_addre6_2_1_</span><span class="p">,</span>
    <span class="n">fromnameli0_</span><span class="p">.</span><span class="n">to_name</span> <span class="k">as</span> <span class="n">to_name7_2_1_</span><span class="p">,</span>
    <span class="n">fromnameli0_</span><span class="p">.</span><span class="n">to_phone_number</span> <span class="k">as</span> <span class="n">to_phone8_2_1_</span> 
<span class="k">from</span>
    <span class="n">sub_order</span> <span class="n">fromnameli0_</span> 
<span class="k">where</span>
    <span class="p">(</span>
        <span class="k">LOWER</span><span class="p">(</span><span class="n">fromnameli0_</span><span class="p">.</span><span class="n">from_name</span><span class="p">)</span> <span class="k">LIKE</span> <span class="s1">'c%'</span>
    <span class="p">)</span> 
    <span class="k">and</span> <span class="n">fromnameli0_</span><span class="p">.</span><span class="n">main_order_id</span><span class="o">=</span><span class="mi">1</span>
</pre></table></code></div></div><p>세 쿼리를 보니 모두 <code class="language-plaintext highlighter-rouge">@Where</code> 어노테이션에 작성한 sql문 대로 잘 수행된것을 확인할 수 있습니다.</p><h3 id="querydsl-에서-사용하기"><span class="mr-2">QueryDSL 에서 사용하기</span><a href="#querydsl-에서-사용하기" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>QueryDSL 에서도 쉽게 사용할 수 있습니다. 예를들어 fromName이 c로 시작하는 SubOrder가 존재하는 경우에만 MainOrder를 가져와야 한다고 가정해보겠습니다.</p><p>평소라면 where절에 직접 서브쿼리를 작성해야 하겠지만, <code class="language-plaintext highlighter-rouge">@Where</code> 어노테이션을 사용하면 쉽게 표현할 수 있습니다. 다음은 예제 / 테스트 코드입니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="nd">@Transactional</span>
<span class="kt">void</span> <span class="nf">whereAnnotationTest2</span><span class="o">()</span> <span class="o">{</span>

    <span class="kt">var</span> <span class="n">mq</span> <span class="o">=</span> <span class="nc">QMainOrder</span><span class="o">.</span><span class="na">mainOrder</span><span class="o">;</span>
    <span class="kt">var</span> <span class="n">sq</span> <span class="o">=</span> <span class="nc">QSubOrder</span><span class="o">.</span><span class="na">subOrder</span><span class="o">;</span>

    <span class="kt">var</span> <span class="n">subQueryFetch</span> <span class="o">=</span> <span class="n">jpaQueryFactory</span>
            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">mq</span><span class="o">)</span>
            <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">mq</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="nc">JPAExpressions</span><span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">sq</span><span class="o">.</span><span class="na">mainOrder</span><span class="o">.</span><span class="na">count</span><span class="o">()).</span><span class="na">from</span><span class="o">(</span><span class="n">sq</span><span class="o">).</span><span class="na">where</span><span class="o">(</span><span class="n">mq</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="n">sq</span><span class="o">.</span><span class="na">mainOrder</span><span class="o">).</span><span class="na">and</span><span class="o">(</span><span class="n">sq</span><span class="o">.</span><span class="na">fromName</span><span class="o">.</span><span class="na">startsWithIgnoreCase</span><span class="o">(</span><span class="s">"c"</span><span class="o">))).</span><span class="na">gt</span><span class="o">(</span><span class="mi">0L</span><span class="o">))</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>

    <span class="kt">var</span> <span class="n">whereAnnotationFetch</span> <span class="o">=</span> <span class="n">jpaQueryFactory</span>
            <span class="o">.</span><span class="na">select</span><span class="o">(</span><span class="n">mq</span><span class="o">)</span>
            <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">mq</span><span class="o">)</span>
            <span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">mq</span><span class="o">.</span><span class="na">fromNameLikeCList</span><span class="o">.</span><span class="na">size</span><span class="o">().</span><span class="na">gt</span><span class="o">(</span><span class="mi">0L</span><span class="o">))</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>

    <span class="nc">Assert</span><span class="o">.</span><span class="na">isTrue</span><span class="o">(</span><span class="n">subQueryFetch</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">==</span> <span class="n">whereAnnotationFetch</span><span class="o">.</span><span class="na">size</span><span class="o">(),</span> <span class="s">"test failed"</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p>첫번째 <code class="language-plaintext highlighter-rouge">subQueryFetch</code>의 경우 where절에 직접 서브쿼리를 작성하였고, 두번째 <code class="language-plaintext highlighter-rouge">whereAnnotationFetch</code>의 경우 단순히 <code class="language-plaintext highlighter-rouge">@OneToMany</code>로 매핑된 엔티티의 사이즈를 불러와 비교하는 방식을 사용하였습니다.</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="k">select</span>
    <span class="n">mainorder0_</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">id1_0_</span><span class="p">,</span>
    <span class="n">mainorder0_</span><span class="p">.</span><span class="n">order_date</span> <span class="k">as</span> <span class="n">order_da2_0_</span> 
<span class="k">from</span>
    <span class="n">main_order</span> <span class="n">mainorder0_</span> 
<span class="k">where</span>
    <span class="p">(</span>
        <span class="k">select</span>
            <span class="k">count</span><span class="p">(</span><span class="n">suborder1_</span><span class="p">.</span><span class="n">main_order_id</span><span class="p">)</span> 
        <span class="k">from</span>
            <span class="n">sub_order</span> <span class="n">suborder1_</span> <span class="k">cross</span> 
        <span class="k">join</span>
            <span class="n">main_order</span> <span class="n">mainorder2_</span> 
        <span class="k">where</span>
            <span class="n">suborder1_</span><span class="p">.</span><span class="n">main_order_id</span><span class="o">=</span><span class="n">mainorder2_</span><span class="p">.</span><span class="n">id</span> 
            <span class="k">and</span> <span class="n">mainorder0_</span><span class="p">.</span><span class="n">id</span><span class="o">=</span><span class="n">suborder1_</span><span class="p">.</span><span class="n">main_order_id</span> 
            <span class="k">and</span> <span class="p">(</span>
                <span class="k">lower</span><span class="p">(</span><span class="n">suborder1_</span><span class="p">.</span><span class="n">from_name</span><span class="p">)</span> <span class="k">like</span> <span class="s1">'c%'</span> <span class="k">escape</span> <span class="s1">'!'</span>
            <span class="p">)</span>
    <span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span>
</pre></table></code></div></div><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="k">select</span>
    <span class="n">mainorder0_</span><span class="p">.</span><span class="n">id</span> <span class="k">as</span> <span class="n">id1_0_</span><span class="p">,</span>
    <span class="n">mainorder0_</span><span class="p">.</span><span class="n">order_date</span> <span class="k">as</span> <span class="n">order_da2_0_</span> 
<span class="k">from</span>
    <span class="n">main_order</span> <span class="n">mainorder0_</span> 
<span class="k">where</span>
    <span class="p">(</span>
        <span class="k">select</span>
            <span class="k">count</span><span class="p">(</span><span class="n">fromnameli1_</span><span class="p">.</span><span class="n">main_order_id</span><span class="p">)</span> 
        <span class="k">from</span>
            <span class="n">sub_order</span> <span class="n">fromnameli1_</span> 
        <span class="k">where</span>
            <span class="n">mainorder0_</span><span class="p">.</span><span class="n">id</span> <span class="o">=</span> <span class="n">fromnameli1_</span><span class="p">.</span><span class="n">main_order_id</span> 
            <span class="k">and</span> <span class="p">(</span>
                <span class="k">LOWER</span><span class="p">(</span><span class="n">fromnameli1_</span><span class="p">.</span><span class="n">from_name</span><span class="p">)</span> <span class="k">LIKE</span> <span class="s1">'c%'</span>
            <span class="p">)</span> 
    <span class="p">)</span><span class="o">&gt;</span><span class="mi">0</span>
</pre></table></code></div></div><p>테스트도 통과하고 결과도 동일한것을 확인할 수 있습니다. 이처럼 QueryDSL에도 쉽게 사용가능한 것을 확인할 수 있습니다.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hibernate/'>Hibernate</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/hibernate/" class="post-tag no-text-decoration" >Hibernate</a> <a href="/tags/jpa/" class="post-tag no-text-decoration" >JPA</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hibernate+%40Where+-+keencho%27s+blog&url=https%3A%2F%2Fkeencho.github.io%2Fposts%2Fhibernate-where%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hibernate+%40Where+-+keencho%27s+blog&u=https%3A%2F%2Fkeencho.github.io%2Fposts%2Fhibernate-where%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fkeencho.github.io%2Fposts%2Fhibernate-where%2F&text=Hibernate+%40Where+-+keencho%27s+blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/jpa-flush/">JPA & Hibernate Flush Mode</a><li><a href="/posts/aws-cicd-1/">AWS를 사용해 무중단 배포 자동화 환경 구축하기 - 1. 개요</a><li><a href="/posts/terraform-aws-infra-6/">Terraform으로 AWS 무중단 배포 인프라 구성하기 - 6. 운영환경 (백엔드)</a><li><a href="/posts/aapt2-arm/">Arm 아키텍처에서 AAPT2 빌드 도구 사용하기</a><li><a href="/posts/terraform-aws-infra-1/">Terraform으로 AWS 무중단 배포 인프라 구성하기 - 1. 개요</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/design-pattern/">Design Pattern</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/hibernate/">Hibernate</a> <a class="post-tag" href="/tags/ecs/">ECS</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/querydsl/">QueryDSL</a> <a class="post-tag" href="/tags/react/">React</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/jpa-entity-listener-di/"><div class="card-body"> <em class="small" data-ts="1647515520" data-df="ll" > Mar 17, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>JPA EntityListeners 에 의존성 주입하기</h3><div class="text-muted small"><p> JPA EntityListeners JPA를 사용하다보면 여러가지 상황(before insert, after insert, before update, after update…)을 캐치하여 작업을 해야할 경우가 생기곤 합니다. 그럴때 하이버네이트 에서 제공하는 EntityListeners를 사용하여 원하는 작업을 수행할 수 있습니다. 위 캡쳐 이미...</p></div></div></a></div><div class="card"> <a href="/posts/jpa-union/"><div class="card-body"> <em class="small" data-ts="1673759520" data-df="ll" > Jan 15, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hibernate, Spring Data JPA, QueryDSL 에서 UNION 사용하기</h3><div class="text-muted small"><p> JPA 에서 union 사용하기 JPA 환경에서 집합 연산자(UNION, UNION ALL, INTERSECT, EXCEPT)를 사용할 수 있을까요? JPA의 버전이 3.1까지 올라왔어도 아직 이에대한 명세, 지원은 없는 것으로 보입니다. native sql로 작성하면 안되는 쿼리는 없긴 합니다만, 추상화된 SQL을 사용할 수 없다는 단점이 존재합니다...</p></div></div></a></div><div class="card"> <a href="/posts/use-java-record-in-jpa-hibernate/"><div class="card-body"> <em class="small" data-ts="1678360320" data-df="ll" > Mar 9, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>JPA 에서 Java Record 사용하기</h3><div class="text-muted small"><p> JPA 에서 Java Record 사용하기 Java Record 자바 레코드는 JDK14에서 preview로써 처음 등장했으며 JDK16에서 정식 스펙으로 포함된 기능입니다. 이는 클래스의 기능과 데이터 구조를 결합한 새로운 클래스 유형입니다. 레코드는 record 예약어를 사용합니다. 레코드의 구성요소들은 메서드의 매개변수 정의와 동일한 형태의 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/react-multitab/" class="btn btn-outline-primary" prompt="Older"><p>리액트로 멀티탭 구현하기 (feat. Recoil)</p></a> <a href="/posts/aws-cicd-5/" class="btn btn-outline-primary" prompt="Newer"><p>AWS를 사용해 무중단 배포 자동화 환경 구축하기 - 5. AWS 리소스 세팅</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/keencho">keencho</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/design-pattern/">Design Pattern</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/hibernate/">Hibernate</a> <a class="post-tag" href="/tags/ecs/">ECS</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/querydsl/">QueryDSL</a> <a class="post-tag" href="/tags/react/">React</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
