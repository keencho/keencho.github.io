<!DOCTYPE html><html lang="ko-KS" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Hibernate, JPA 에서 발생하는 Cross Join 문제 해결하기" /><meta name="author" content="keencho" /><meta property="og:locale" content="ko_KS" /><meta name="description" content="Hibernate, JPA 에서 발생하는 Cross Join 문제 해결하기" /><meta property="og:description" content="Hibernate, JPA 에서 발생하는 Cross Join 문제 해결하기" /><link rel="canonical" href="https://keencho.github.io/posts/hibernate-cross-join/" /><meta property="og:url" content="https://keencho.github.io/posts/hibernate-cross-join/" /><meta property="og:site_name" content="keencho’s blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-07-20T20:12:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hibernate, JPA 에서 발생하는 Cross Join 문제 해결하기" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@keencho" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"keencho"},"dateModified":"2022-07-21T15:19:13+09:00","datePublished":"2022-07-20T20:12:00+09:00","description":"Hibernate, JPA 에서 발생하는 Cross Join 문제 해결하기","headline":"Hibernate, JPA 에서 발생하는 Cross Join 문제 해결하기","mainEntityOfPage":{"@type":"WebPage","@id":"https://keencho.github.io/posts/hibernate-cross-join/"},"url":"https://keencho.github.io/posts/hibernate-cross-join/"}</script><title>Hibernate, JPA 에서 발생하는 Cross Join 문제 해결하기 | keencho's blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="keencho's blog"><meta name="application-name" content="keencho's blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/custom/keencho.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">keencho's blog</a></div><div class="site-subtitle font-italic">이것저것 정리하는 블로그.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/keencho" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['seyoung050412','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hibernate, JPA 에서 발생하는 Cross Join 문제 해결하기</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Hibernate, JPA 에서 발생하는 Cross Join 문제 해결하기</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1658315520" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jul 20, 2022 </em> </span><div class="d-flex justify-content-between"> <span> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1871 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><h1 id="hibernate-jpa-에서-발생하는-cross-join-문제-해결하기"><strong>Hibernate, JPA 에서 발생하는 Cross Join 문제 해결하기</strong></h1><h2 id="개요"><span class="mr-2"><strong>개요</strong></span><a href="#개요" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>평화롭게 코딩하던 어느날, 쿼리 결과가 의도한대로 리턴되지 않는 문제가 발생하였습니다. 쿼리에 문제가 있나 싶어 자세히 살펴봤지만 (queryDSL을 사용중이었습니다.) 자바 코드상의 문제는 찾을 수 없었습니다.</p><p>데이터베이스에 날라가는 sql문을 보고 나서야 문제를 찾을수 있었고 이 포스팅에서는 그 문제와 해결 과정을 적어보려고 합니다.</p><h2 id="cross-join-발생"><span class="mr-2"><strong>Cross Join 발생</strong></span><a href="#cross-join-발생" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>문제는 cross join 발생한다는 것이었습니다. 당연히 left join이 발생할 것이라고 생각하였지만 cross join이 발생하여 결과가 의도한대로 리턴되지 않은 것이지요.</p><p>cross join은 두 테이블에서 행의 모든 조합을 반환하는 join입니다. 하이버네이트가 쿼리를 생성하는 과정에 where 조건절에 cross join과 관련된 조건이 추가되어 원하는 결과가 넘어오지 않았던 것이지요.</p><p>하이버네이트는 join을 명시적으로 지정하지 않으면 암묵적으로 cross join으로 지정하는 경향(?) 이 었다고 합니다. 하이버네이트의 창시자인 <code class="language-plaintext highlighter-rouge">Gavin King</code>, <code class="language-plaintext highlighter-rouge">Christian Bauer</code>의 책인 <code class="language-plaintext highlighter-rouge">Hibernate in Action</code> 에는 이런 내용이 있습니다.</p><blockquote><p>Implicit joins are always directed along many-to-one or one-to-one association, never through a collection-valued association.</p></blockquote><p>암묵적 join은 항상 many-to-one 혹은 one-to-one 연관성에 따라 결정되며 컬렉션 값에 따라 지정되지 않는다고 합니다.</p><p>또한 대부분의 데이터베이스 엔진들은 cross join에 대해 where 조건을 추가하기 때문에 결과적으로 cross join / where 에 의해 원하는 결과값이 나오지 않게 되는 것입니다.</p><h2 id="문제-재구현"><span class="mr-2"><strong>문제 재구현</strong></span><a href="#문제-재구현" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>jpa / querydsl을 사용해 문제를 재구현 해보겠습니다.</p><p>‘일’을 위한 테이블이 있습니다. 이 일은 개발자나 영업사원에게 배정될 수 있습니다. 개발자나 영업사원은 한 회사에 속해 있어야 합니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
</pre><td class="rouge-code"><pre><span class="nd">@Entity</span>
<span class="nd">@Data</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"COMPANY"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Company</span> <span class="o">{</span>
    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">AUTO</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Company</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Entity</span>
<span class="nd">@Data</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"DEV_TEAM_MEMBERS"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">DevTeamMember</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">AUTO</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span><span class="o">(</span><span class="n">optional</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"COMPANY_ID"</span><span class="o">,</span> <span class="n">foreignKey</span> <span class="o">=</span> <span class="nd">@ForeignKey</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"DEV_TEAM_MEMBERS___COMPANY"</span><span class="o">))</span>
    <span class="kd">private</span> <span class="nc">Company</span> <span class="n">company</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">DevTeamMember</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">Company</span> <span class="n">company</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">company</span> <span class="o">=</span> <span class="n">company</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Entity</span>
<span class="nd">@Data</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"SALES_TEAM_MEMBERS"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">SalesTeamMembers</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">AUTO</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span><span class="o">(</span><span class="n">optional</span> <span class="o">=</span> <span class="kc">false</span><span class="o">,</span> <span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"COMPANY_ID"</span><span class="o">,</span> <span class="n">foreignKey</span> <span class="o">=</span> <span class="nd">@ForeignKey</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"FK_SALES_TEAM_MEMBERS___COMPANY"</span><span class="o">))</span>
    <span class="kd">private</span> <span class="nc">Company</span> <span class="n">company</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">SalesTeamMembers</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">Company</span> <span class="n">company</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">company</span> <span class="o">=</span> <span class="n">company</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="nd">@Entity</span>
<span class="nd">@Data</span>
<span class="nd">@AllArgsConstructor</span>
<span class="nd">@NoArgsConstructor</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"JOB"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Job</span> <span class="o">{</span>

    <span class="nd">@Id</span>
    <span class="nd">@GeneratedValue</span><span class="o">(</span><span class="n">strategy</span> <span class="o">=</span> <span class="nc">GenerationType</span><span class="o">.</span><span class="na">AUTO</span><span class="o">)</span>
    <span class="kd">private</span> <span class="nc">Long</span> <span class="n">id</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">String</span> <span class="n">name</span><span class="o">;</span>

    <span class="kd">private</span> <span class="nc">LocalDateTime</span> <span class="n">dtCreatedAt</span> <span class="o">=</span> <span class="nc">LocalDateTime</span><span class="o">.</span><span class="na">now</span><span class="o">();</span>

    <span class="nd">@ManyToOne</span><span class="o">(</span><span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"DEV_TEAM_MEMBERS_ID"</span><span class="o">,</span> <span class="n">foreignKey</span> <span class="o">=</span> <span class="nd">@ForeignKey</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"FK_JOB___DEV_TEAM_MEMBERS"</span><span class="o">))</span>
    <span class="kd">private</span> <span class="nc">DevTeamMember</span> <span class="n">devTeamMembers</span><span class="o">;</span>

    <span class="nd">@ManyToOne</span><span class="o">(</span><span class="n">fetch</span> <span class="o">=</span> <span class="nc">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span>
    <span class="nd">@JoinColumn</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"SALES_TEAM_MEMBERS_ID"</span><span class="o">,</span> <span class="n">foreignKey</span> <span class="o">=</span> <span class="nd">@ForeignKey</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"FK_JOB___SALES_TEAM_MEMBERS"</span><span class="o">))</span>
    <span class="kd">private</span> <span class="nc">SalesTeamMembers</span> <span class="n">salesTeamMembers</span><span class="o">;</span>

    <span class="kd">public</span> <span class="nf">Job</span><span class="o">(</span><span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">DevTeamMember</span> <span class="n">devTeamMembers</span><span class="o">,</span> <span class="nc">SalesTeamMembers</span> <span class="n">salesTeamMembers</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">devTeamMembers</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">&amp;&amp;</span> <span class="n">salesTeamMembers</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">throw</span> <span class="k">new</span> <span class="nf">RuntimeException</span><span class="o">(</span><span class="s">"Work must be assigned to one person."</span><span class="o">);</span>
        <span class="o">}</span>
        <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">devTeamMembers</span> <span class="o">=</span> <span class="n">devTeamMembers</span><span class="o">;</span>
        <span class="k">this</span><span class="o">.</span><span class="na">salesTeamMembers</span> <span class="o">=</span> <span class="n">salesTeamMembers</span><span class="o">;</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>순서대로 회사, 개발자, 영업사원, 일 순서입니다. 테이블을 만들었으니 repository들을 각각 생성합니다.</p><p>repository를 생성하였다면 test코드를 작성해 보겠습니다. 일단 더미데이터 생성 코드입니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="nd">@BeforeEach</span>
<span class="kt">void</span> <span class="nf">initDummyData</span><span class="o">()</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="n">kakao</span> <span class="o">=</span> <span class="n">companyRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">Company</span><span class="o">(</span><span class="s">"카카오"</span><span class="o">));</span>
    <span class="kt">var</span> <span class="n">naver</span> <span class="o">=</span> <span class="n">companyRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">Company</span><span class="o">(</span><span class="s">"네이버"</span><span class="o">));</span>

    <span class="kt">var</span> <span class="n">kakao_dev_1</span> <span class="o">=</span> <span class="n">devTeamMembersRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">DevTeamMember</span><span class="o">(</span><span class="s">"카카오_개발자_1"</span><span class="o">,</span> <span class="n">kakao</span><span class="o">));</span>
    <span class="kt">var</span> <span class="n">kakao_dev_2</span> <span class="o">=</span> <span class="n">devTeamMembersRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">DevTeamMember</span><span class="o">(</span><span class="s">"카카오_개발자_2"</span><span class="o">,</span> <span class="n">kakao</span><span class="o">));</span>

    <span class="kt">var</span> <span class="n">naver_dev_1</span> <span class="o">=</span> <span class="n">devTeamMembersRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">DevTeamMember</span><span class="o">(</span><span class="s">"네이버_개발자_1"</span><span class="o">,</span> <span class="n">naver</span><span class="o">));</span>
    <span class="kt">var</span> <span class="n">naver_dev_2</span> <span class="o">=</span> <span class="n">devTeamMembersRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">DevTeamMember</span><span class="o">(</span><span class="s">"네이버_개발자_2"</span><span class="o">,</span> <span class="n">naver</span><span class="o">));</span>

    <span class="kt">var</span> <span class="n">kakao_sales_1</span> <span class="o">=</span> <span class="n">salesTeamMembersRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">SalesTeamMembers</span><span class="o">(</span><span class="s">"카카오_영업사원_1"</span><span class="o">,</span> <span class="n">kakao</span><span class="o">));</span>
    <span class="kt">var</span> <span class="n">kakao_sales_2</span> <span class="o">=</span> <span class="n">salesTeamMembersRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">SalesTeamMembers</span><span class="o">(</span><span class="s">"카카오_영업사원_2"</span><span class="o">,</span> <span class="n">kakao</span><span class="o">));</span>

    <span class="kt">var</span> <span class="n">naver_sales_1</span> <span class="o">=</span> <span class="n">salesTeamMembersRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">SalesTeamMembers</span><span class="o">(</span><span class="s">"네이버_영업사원_1"</span><span class="o">,</span> <span class="n">naver</span><span class="o">));</span>
    <span class="kt">var</span> <span class="n">naver_sales_2</span> <span class="o">=</span> <span class="n">salesTeamMembersRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">SalesTeamMembers</span><span class="o">(</span><span class="s">"네이버_영업사원_2"</span><span class="o">,</span> <span class="n">naver</span><span class="o">));</span>

    <span class="n">jobRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">Job</span><span class="o">(</span><span class="s">"AWS EC2 인스턴스 생성"</span><span class="o">,</span> <span class="n">kakao_dev_1</span><span class="o">,</span> <span class="kc">null</span><span class="o">));</span>
    <span class="n">jobRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">Job</span><span class="o">(</span><span class="s">"AWS RDS 인스턴스 생성"</span><span class="o">,</span> <span class="n">kakao_dev_2</span><span class="o">,</span> <span class="kc">null</span><span class="o">));</span>
    <span class="n">jobRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">Job</span><span class="o">(</span><span class="s">"Spring Boot 프로젝트 생성"</span><span class="o">,</span> <span class="n">naver_dev_1</span><span class="o">,</span> <span class="kc">null</span><span class="o">));</span>
    <span class="n">jobRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">Job</span><span class="o">(</span><span class="s">"React 프로젝트 생성"</span><span class="o">,</span> <span class="n">naver_dev_2</span><span class="o">,</span> <span class="kc">null</span><span class="o">));</span>

    <span class="n">jobRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">Job</span><span class="o">(</span><span class="s">"매출목표 설정"</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="n">kakao_sales_1</span><span class="o">));</span>
    <span class="n">jobRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">Job</span><span class="o">(</span><span class="s">"외근"</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="n">kakao_sales_2</span><span class="o">));</span>
    <span class="n">jobRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">Job</span><span class="o">(</span><span class="s">"제품 소개서 만들기"</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="n">naver_sales_1</span><span class="o">));</span>
    <span class="n">jobRepository</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="k">new</span> <span class="nc">Job</span><span class="o">(</span><span class="s">"월말 수금"</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="n">naver_sales_2</span><span class="o">));</span>
<span class="o">}</span>
</pre></table></code></div></div><p>다음은 테스트 코드입니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>

    <span class="kt">var</span> <span class="n">q</span> <span class="o">=</span> <span class="nc">QJob</span><span class="o">.</span><span class="na">job</span><span class="o">;</span>

    <span class="kt">var</span> <span class="n">r</span> <span class="o">=</span> <span class="n">jpaQueryFactory</span>
            <span class="o">.</span><span class="na">select</span><span class="o">(</span>
                    <span class="n">q</span><span class="o">.</span><span class="na">id</span><span class="o">,</span>
                    <span class="k">new</span> <span class="nf">CaseBuilder</span><span class="o">()</span>
                            <span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">devTeamMembers</span><span class="o">.</span><span class="na">isNotNull</span><span class="o">()).</span><span class="na">then</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">devTeamMembers</span><span class="o">.</span><span class="na">name</span><span class="o">)</span>
                            <span class="o">.</span><span class="na">otherwise</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">salesTeamMembers</span><span class="o">.</span><span class="na">name</span><span class="o">),</span>
                    <span class="k">new</span> <span class="nf">CaseBuilder</span><span class="o">()</span>
                            <span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">devTeamMembers</span><span class="o">.</span><span class="na">isNotNull</span><span class="o">()).</span><span class="na">then</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">devTeamMembers</span><span class="o">.</span><span class="na">company</span><span class="o">.</span><span class="na">name</span><span class="o">)</span>
                            <span class="o">.</span><span class="na">otherwise</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">salesTeamMembers</span><span class="o">.</span><span class="na">company</span><span class="o">.</span><span class="na">name</span><span class="o">)</span>
            <span class="o">)</span>
            <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">q</span><span class="o">)</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>

    <span class="nc">Assert</span><span class="o">.</span><span class="na">isTrue</span><span class="o">(</span><span class="n">r</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">==</span> <span class="mi">8</span><span class="o">,</span> <span class="s">"예상된 결과와 다릅니다."</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p>job을 8개 생성하였기 때문에 위 테스트는 정상적으로 통과해야 합니다. 그러나 쿼리 결과 list의 size가 0이되어 테스트에 실패합니다.</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="k">select</span> <span class="n">job0_</span><span class="p">.</span><span class="n">id</span>                                                                                          <span class="k">as</span> <span class="n">col_0_0_</span><span class="p">,</span>
       <span class="k">case</span> <span class="k">when</span> <span class="n">job0_</span><span class="p">.</span><span class="n">dev_team_members_id</span> <span class="k">is</span> <span class="k">not</span> <span class="k">null</span> <span class="k">then</span> <span class="n">devteammem1_</span><span class="p">.</span><span class="n">name</span> <span class="k">else</span> <span class="n">salesteamm2_</span><span class="p">.</span><span class="n">name</span> <span class="k">end</span> <span class="k">as</span> <span class="n">col_1_0_</span><span class="p">,</span>
       <span class="k">case</span> <span class="k">when</span> <span class="n">job0_</span><span class="p">.</span><span class="n">dev_team_members_id</span> <span class="k">is</span> <span class="k">not</span> <span class="k">null</span> <span class="k">then</span> <span class="n">company4_</span><span class="p">.</span><span class="n">name</span> <span class="k">else</span> <span class="n">company6_</span><span class="p">.</span><span class="n">name</span> <span class="k">end</span>       <span class="k">as</span> <span class="n">col_2_0_</span>
<span class="k">from</span> <span class="n">job</span> <span class="n">job0_</span>
         <span class="k">cross</span> <span class="k">join</span> <span class="n">dev_team_members</span> <span class="n">devteammem1_</span>
         <span class="k">cross</span> <span class="k">join</span> <span class="n">company</span> <span class="n">company4_</span>
         <span class="k">cross</span> <span class="k">join</span> <span class="n">sales_team_members</span> <span class="n">salesteamm2_</span>
         <span class="k">cross</span> <span class="k">join</span> <span class="n">company</span> <span class="n">company6_</span>
<span class="k">where</span> <span class="n">job0_</span><span class="p">.</span><span class="n">dev_team_members_id</span> <span class="o">=</span> <span class="n">devteammem1_</span><span class="p">.</span><span class="n">id</span>
  <span class="k">and</span> <span class="n">devteammem1_</span><span class="p">.</span><span class="n">company_id</span> <span class="o">=</span> <span class="n">company4_</span><span class="p">.</span><span class="n">id</span>
  <span class="k">and</span> <span class="n">job0_</span><span class="p">.</span><span class="n">sales_team_members_id</span> <span class="o">=</span> <span class="n">salesteamm2_</span><span class="p">.</span><span class="n">id</span>
  <span class="k">and</span> <span class="n">salesteamm2_</span><span class="p">.</span><span class="n">company_id</span> <span class="o">=</span> <span class="n">company6_</span><span class="p">.</span><span class="n">id</span>
</pre></table></code></div></div><p>생성된 sql 문입니다. 당연히 left join이 걸릴줄 알았으나 cross join이 걸렸습니다. 또한 where 조건이 추가되어 원하는 결과가 나오지 않았습니다.</p><h2 id="문제-해결"><span class="mr-2"><strong>문제 해결</strong></span><a href="#문제-해결" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>문제 해결은 간단합니다. join을 명시적으로 지정해주면 됩니다.</p><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">test</span><span class="o">()</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="n">q</span> <span class="o">=</span> <span class="nc">QJob</span><span class="o">.</span><span class="na">job</span><span class="o">;</span>

    <span class="kt">var</span> <span class="n">r</span> <span class="o">=</span> <span class="n">jpaQueryFactory</span>
            <span class="o">.</span><span class="na">select</span><span class="o">(</span>
                    <span class="n">q</span><span class="o">.</span><span class="na">id</span><span class="o">,</span>
                    <span class="k">new</span> <span class="nf">CaseBuilder</span><span class="o">()</span>
                            <span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">devTeamMembers</span><span class="o">.</span><span class="na">isNotNull</span><span class="o">()).</span><span class="na">then</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">devTeamMembers</span><span class="o">.</span><span class="na">name</span><span class="o">)</span>
                            <span class="o">.</span><span class="na">otherwise</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">salesTeamMembers</span><span class="o">.</span><span class="na">name</span><span class="o">),</span>
                    <span class="k">new</span> <span class="nf">CaseBuilder</span><span class="o">()</span>
                            <span class="o">.</span><span class="na">when</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">devTeamMembers</span><span class="o">.</span><span class="na">isNotNull</span><span class="o">()).</span><span class="na">then</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">devTeamMembers</span><span class="o">.</span><span class="na">company</span><span class="o">.</span><span class="na">name</span><span class="o">)</span>
                            <span class="o">.</span><span class="na">otherwise</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">salesTeamMembers</span><span class="o">.</span><span class="na">company</span><span class="o">.</span><span class="na">name</span><span class="o">)</span>
            <span class="o">)</span>
            <span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="n">q</span><span class="o">)</span>
            <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">devTeamMembers</span><span class="o">).</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">devTeamMembers</span><span class="o">.</span><span class="na">company</span><span class="o">)</span>
            <span class="o">.</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">salesTeamMembers</span><span class="o">).</span><span class="na">leftJoin</span><span class="o">(</span><span class="n">q</span><span class="o">.</span><span class="na">salesTeamMembers</span><span class="o">.</span><span class="na">company</span><span class="o">)</span>
            <span class="o">.</span><span class="na">fetch</span><span class="o">();</span>

    <span class="nc">Assert</span><span class="o">.</span><span class="na">isTrue</span><span class="o">(</span><span class="n">r</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">==</span> <span class="mi">8</span><span class="o">,</span> <span class="s">"예상된 결과와 다릅니다."</span><span class="o">);</span>
<span class="o">}</span>
</pre></table></code></div></div><p>join을 명시적으로 지정하고 테스트를 수행하니 정상적으로 통과합니다!</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">select</span> <span class="n">job0_</span><span class="p">.</span><span class="n">id</span>                                                                                          <span class="k">as</span> <span class="n">col_0_0_</span><span class="p">,</span>
       <span class="k">case</span> <span class="k">when</span> <span class="n">job0_</span><span class="p">.</span><span class="n">dev_team_members_id</span> <span class="k">is</span> <span class="k">not</span> <span class="k">null</span> <span class="k">then</span> <span class="n">devteammem2_</span><span class="p">.</span><span class="n">name</span> <span class="k">else</span> <span class="n">salesteamm5_</span><span class="p">.</span><span class="n">name</span> <span class="k">end</span> <span class="k">as</span> <span class="n">col_1_0_</span><span class="p">,</span>
       <span class="k">case</span> <span class="k">when</span> <span class="n">job0_</span><span class="p">.</span><span class="n">dev_team_members_id</span> <span class="k">is</span> <span class="k">not</span> <span class="k">null</span> <span class="k">then</span> <span class="n">company3_</span><span class="p">.</span><span class="n">name</span> <span class="k">else</span> <span class="n">company6_</span><span class="p">.</span><span class="n">name</span> <span class="k">end</span>       <span class="k">as</span> <span class="n">col_2_0_</span>
<span class="k">from</span> <span class="n">job</span> <span class="n">job0_</span>
         <span class="k">left</span> <span class="k">outer</span> <span class="k">join</span> <span class="n">dev_team_members</span> <span class="n">devteammem1_</span> <span class="k">on</span> <span class="n">job0_</span><span class="p">.</span><span class="n">dev_team_members_id</span> <span class="o">=</span> <span class="n">devteammem1_</span><span class="p">.</span><span class="n">id</span>
         <span class="k">left</span> <span class="k">outer</span> <span class="k">join</span> <span class="n">dev_team_members</span> <span class="n">devteammem2_</span> <span class="k">on</span> <span class="n">job0_</span><span class="p">.</span><span class="n">dev_team_members_id</span> <span class="o">=</span> <span class="n">devteammem2_</span><span class="p">.</span><span class="n">id</span>
         <span class="k">left</span> <span class="k">outer</span> <span class="k">join</span> <span class="n">company</span> <span class="n">company3_</span> <span class="k">on</span> <span class="n">devteammem2_</span><span class="p">.</span><span class="n">company_id</span> <span class="o">=</span> <span class="n">company3_</span><span class="p">.</span><span class="n">id</span>
         <span class="k">left</span> <span class="k">outer</span> <span class="k">join</span> <span class="n">sales_team_members</span> <span class="n">salesteamm4_</span> <span class="k">on</span> <span class="n">job0_</span><span class="p">.</span><span class="n">sales_team_members_id</span> <span class="o">=</span> <span class="n">salesteamm4_</span><span class="p">.</span><span class="n">id</span>
         <span class="k">left</span> <span class="k">outer</span> <span class="k">join</span> <span class="n">sales_team_members</span> <span class="n">salesteamm5_</span> <span class="k">on</span> <span class="n">job0_</span><span class="p">.</span><span class="n">sales_team_members_id</span> <span class="o">=</span> <span class="n">salesteamm5_</span><span class="p">.</span><span class="n">id</span>
         <span class="k">left</span> <span class="k">outer</span> <span class="k">join</span> <span class="n">company</span> <span class="n">company6_</span> <span class="k">on</span> <span class="n">salesteamm5_</span><span class="p">.</span><span class="n">company_id</span> <span class="o">=</span> <span class="n">company6_</span><span class="p">.</span><span class="n">id</span><span class="p">;</span>
</pre></table></code></div></div><p>생성된 sql문을 보면 의도한대로 join이 걸린 것을 확인할 수 있습니다.</p><h2 id="결론"><span class="mr-2"><strong>결론</strong></span><a href="#결론" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>join을 명시적으로 지정하지 않으면 cross join이 걸려 원하는 결과를 얻을수 없는 문제가 발생할 수 있습니다. 이를 피하기 위한 설정(?) 같은게 있으면 좋겠지만 그런 설정은 아직까지 없는 것으로 보입니다.</p><p>위 문제는 join을 명시적으로 지정하여 문제를 쉽게 해결할 수 있으니 문제 해결에 도움이 되면 좋겠습니다.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hibernate/'>Hibernate</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/jpa/" class="post-tag no-text-decoration" >JPA</a> <a href="/tags/hibernate/" class="post-tag no-text-decoration" >Hibernate</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hibernate%2C+JPA+%EC%97%90%EC%84%9C+%EB%B0%9C%EC%83%9D%ED%95%98%EB%8A%94+Cross+Join+%EB%AC%B8%EC%A0%9C+%ED%95%B4%EA%B2%B0%ED%95%98%EA%B8%B0+-+keencho%27s+blog&url=https%3A%2F%2Fkeencho.github.io%2Fposts%2Fhibernate-cross-join%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hibernate%2C+JPA+%EC%97%90%EC%84%9C+%EB%B0%9C%EC%83%9D%ED%95%98%EB%8A%94+Cross+Join+%EB%AC%B8%EC%A0%9C+%ED%95%B4%EA%B2%B0%ED%95%98%EA%B8%B0+-+keencho%27s+blog&u=https%3A%2F%2Fkeencho.github.io%2Fposts%2Fhibernate-cross-join%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fkeencho.github.io%2Fposts%2Fhibernate-cross-join%2F&text=Hibernate%2C+JPA+%EC%97%90%EC%84%9C+%EB%B0%9C%EC%83%9D%ED%95%98%EB%8A%94+Cross+Join+%EB%AC%B8%EC%A0%9C+%ED%95%B4%EA%B2%B0%ED%95%98%EA%B8%B0+-+keencho%27s+blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/jpa-flush/">JPA & Hibernate Flush Mode</a><li><a href="/posts/aws-cicd-1/">AWS를 사용해 무중단 배포 자동화 환경 구축하기 - 1. 개요</a><li><a href="/posts/terraform-aws-infra-6/">Terraform으로 AWS 무중단 배포 인프라 구성하기 - 6. 운영환경 (백엔드)</a><li><a href="/posts/aapt2-arm/">Arm 아키텍처에서 AAPT2 빌드 도구 사용하기</a><li><a href="/posts/terraform-aws-infra-1/">Terraform으로 AWS 무중단 배포 인프라 구성하기 - 1. 개요</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/design-pattern/">Design Pattern</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/hibernate/">Hibernate</a> <a class="post-tag" href="/tags/ecs/">ECS</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/querydsl/">QueryDSL</a> <a class="post-tag" href="/tags/react/">React</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/jpa-entity-listener-di/"><div class="card-body"> <em class="small" data-ts="1647515520" data-df="ll" > Mar 17, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>JPA EntityListeners 에 의존성 주입하기</h3><div class="text-muted small"><p> JPA EntityListeners JPA를 사용하다보면 여러가지 상황(before insert, after insert, before update, after update…)을 캐치하여 작업을 해야할 경우가 생기곤 합니다. 그럴때 하이버네이트 에서 제공하는 EntityListeners를 사용하여 원하는 작업을 수행할 수 있습니다. 위 캡쳐 이미...</p></div></div></a></div><div class="card"> <a href="/posts/jpa-union/"><div class="card-body"> <em class="small" data-ts="1673759520" data-df="ll" > Jan 15, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hibernate, Spring Data JPA, QueryDSL 에서 UNION 사용하기</h3><div class="text-muted small"><p> JPA 에서 union 사용하기 JPA 환경에서 집합 연산자(UNION, UNION ALL, INTERSECT, EXCEPT)를 사용할 수 있을까요? JPA의 버전이 3.1까지 올라왔어도 아직 이에대한 명세, 지원은 없는 것으로 보입니다. native sql로 작성하면 안되는 쿼리는 없긴 합니다만, 추상화된 SQL을 사용할 수 없다는 단점이 존재합니다...</p></div></div></a></div><div class="card"> <a href="/posts/use-java-record-in-jpa-hibernate/"><div class="card-body"> <em class="small" data-ts="1678360320" data-df="ll" > Mar 9, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>JPA 에서 Java Record 사용하기</h3><div class="text-muted small"><p> JPA 에서 Java Record 사용하기 Java Record 자바 레코드는 JDK14에서 preview로써 처음 등장했으며 JDK16에서 정식 스펙으로 포함된 기능입니다. 이는 클래스의 기능과 데이터 구조를 결합한 새로운 클래스 유형입니다. 레코드는 record 예약어를 사용합니다. 레코드의 구성요소들은 메서드의 매개변수 정의와 동일한 형태의 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/aws-alb-ssl/" class="btn btn-outline-primary" prompt="Older"><p>AWS Application Load Balancer에 SSL 인증서 적용하기</p></a> <a href="/posts/spring-security-custom-library/" class="btn btn-outline-primary" prompt="Newer"><p>Spring Security custom library 만들기</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/keencho">keencho</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/design-pattern/">Design Pattern</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/hibernate/">Hibernate</a> <a class="post-tag" href="/tags/ecs/">ECS</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/querydsl/">QueryDSL</a> <a class="post-tag" href="/tags/react/">React</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
