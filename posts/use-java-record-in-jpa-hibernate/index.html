<!DOCTYPE html><html lang="ko-KS" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="JPA 에서 Java Record 사용하기" /><meta name="author" content="keencho" /><meta property="og:locale" content="ko_KS" /><meta name="description" content="JPA 에서 Java Record 사용하기" /><meta property="og:description" content="JPA 에서 Java Record 사용하기" /><link rel="canonical" href="https://keencho.github.io/posts/use-java-record-in-jpa-hibernate/" /><meta property="og:url" content="https://keencho.github.io/posts/use-java-record-in-jpa-hibernate/" /><meta property="og:site_name" content="keencho’s blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-03-09T20:12:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="JPA 에서 Java Record 사용하기" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@keencho" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"keencho"},"dateModified":"2023-03-09T11:36:46+09:00","datePublished":"2023-03-09T20:12:00+09:00","description":"JPA 에서 Java Record 사용하기","headline":"JPA 에서 Java Record 사용하기","mainEntityOfPage":{"@type":"WebPage","@id":"https://keencho.github.io/posts/use-java-record-in-jpa-hibernate/"},"url":"https://keencho.github.io/posts/use-java-record-in-jpa-hibernate/"}</script><title>JPA 에서 Java Record 사용하기 | keencho's blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="keencho's blog"><meta name="application-name" content="keencho's blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end">
<div class="profile-wrapper text-center">
<div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/custom/keencho.jpg" alt="avatar" onerror="this.style.display='none'"> </a>
</div>
<div class="site-title mt-3"> <a href="/">keencho's blog</a>
</div>
<div class="site-subtitle font-italic">이것저것 정리하는 블로그.</div>
</div>
<ul class="w-100">
<li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a>
</li>
<li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a>
</li>
<li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a>
</li>
<li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a>
</li>
<li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a>
</li>
</ul>
<div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/keencho" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="javascript:location.href%20=%20'mailto:'%20+%20['seyoung050412','gmail.com'].join('@')" aria-label="email"> <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss"> <i class="fas fa-rss"></i> </a>
</div>
</div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>JPA 에서 Java Record 사용하기</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div>
<i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel">Cancel</span>
</div></div><div id="main-wrapper" class="d-flex justify-content-center">
<div id="main" class="container pl-xl-4 pr-xl-4">
<div class="row">
<div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2">
<h1 data-toc-skip>JPA 에서 Java Record 사용하기</h1>
<div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1678360320" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Mar 9, 2023 </em> </span><div class="d-flex justify-content-between"> <span> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1842 words"> <em>10 min</em> read</span>
</div>
</div>
</div>
<div class="post-content">
<h1 id="jpa-에서-java-record-사용하기">JPA 에서 Java Record 사용하기</h1>
<h2 id="java-record">
<span class="mr-2">Java Record</span><a href="#java-record" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h2>
<p>자바 레코드는 JDK14에서 preview로써 처음 등장했으며 JDK16에서 정식 스펙으로 포함된 기능입니다. 이는 클래스의 기능과 데이터 구조를 결합한 새로운 클래스 유형입니다.</p>
<p>레코드는 <code class="language-plaintext highlighter-rouge">record</code> 예약어를 사용합니다. 레코드의 구성요소들은 메서드의 매개변수 정의와 동일한 형태의 구문을 사용하여 정의되며 타입과 이름을 포합합니다.</p>
<p>예를들어 좌표를 나타내는 레코드는 다음과 같이 정의할 수 있습니다.</p>
<div class="language-java highlighter-rouge">
<div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td>
<td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">record</span> <span class="nf">Coordinates</span><span class="o">(</span><span class="kt">double</span> <span class="n">x</span><span class="o">,</span> <span class="kt">double</span> <span class="n">y</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<p>두 좌표 (x, y)를 보유하는 불변 객체를 생성하며 기존 클래스 형태의 객체에서 일반적으로 정의한 상용어구 코드 (constructor, getter, toString, hashCode, equals)를 정의하지 않아도 기본 구현을 제공하므로 클래스보다 간결한 방법으로 객체를 정의할 수 있습니다.</p>
<h2 id="entity로-사용하기">
<span class="mr-2">Entity로 사용하기</span><a href="#entity%EB%A1%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h2>
<p>아쉽게도 JPA에서는 Record를 Entity로 사용할 수 없습니다. JPA 사양을 만족하는 엔티티 객체는 다음과 같은 요구사항을 충족해야 하기 때문입니다.</p>
<ol>
<li>
<code class="language-plaintext highlighter-rouge">@Entity</code> 어노테이션이 선언되어야 합니다.</li>
<li>매개변수가 없는 생성자가 <code class="language-plaintext highlighter-rouge">public</code> 혹은 <code class="language-plaintext highlighter-rouge">protected</code>으로 선언되어 있어야 합니다. JPA 구현체들이 쿼리 결과를 매핑할때 객체를 인스턴스화 할수 있어야 하기 때문입니다.</li>
<li>JPA 구현체가 프록시 객체를 생성해야 하기 때문에 final로 선언되지 않아야 합니다.</li>
<li>엔티티 객체임을 확인하기 위해 하나 혹은 그 이상의 필드를 선언해야 합니다.</li>
<li>필드를 db 컬럼으로 매핑하기 위해서 필드는 final이 아니어야 합니다.</li>
<li>필드에 접근하기 위해 getter와 setter를 제공해야 합니다.</li>
</ol>
<p>레코드는 매개 변수가 없는 생성자를 지원하지 않으며 클래스 자체가 final 클래스입니다. 레코드의 필드들 또한 final이며, 접근 메소드들 또한 요구사항에 적합한 네이밍 전략을 따르지 않습니다. 이러한 이유들 때문에 아직까지 JPA 에서는 Record를 Entity로 사용할 수 없습니다.</p>
<h2 id="dto로-사용하기">
<span class="mr-2">DTO로 사용하기</span><a href="#dto%EB%A1%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h2>
<p>조회한 정보를 변경하지 않는다면 DTO는 최고의 선택입니다. 이는 엔티티를 직접 조회하는 것보다 성능이 뛰어나며 도메인 모델과 API를 분리할 수 있습니다.</p>
<p>JPA의 <code class="language-plaintext highlighter-rouge">Criteriabuilder.construct</code> 메소드를 사용하여 <code class="language-plaintext highlighter-rouge">CriteriaQuery</code>에서 생성자 호출을 정의할 수 있습니다.</p>
<div class="language-java highlighter-rouge">
<div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td>
<td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">record</span> <span class="nf">OrderRecord</span><span class="o">(</span>
        <span class="nc">String</span> <span class="n">id</span><span class="o">,</span>
        <span class="nc">OrderStatus</span> <span class="n">status</span><span class="o">,</span>
        <span class="nc">String</span> <span class="n">fromAddress</span><span class="o">,</span>
        <span class="nc">String</span> <span class="n">fromName</span><span class="o">,</span>
        <span class="nc">String</span> <span class="n">fromPhoneNumber</span><span class="o">,</span>
        <span class="nc">String</span> <span class="n">toAddress</span><span class="o">,</span>
        <span class="nc">String</span> <span class="n">toName</span><span class="o">,</span>
        <span class="nc">String</span> <span class="n">toPhoneNumber</span><span class="o">,</span>
        <span class="nc">String</span> <span class="n">itemName</span><span class="o">,</span>
        <span class="kt">int</span> <span class="n">itemPrice</span><span class="o">,</span>
        <span class="nc">LocalDateTime</span> <span class="n">createdDateTime</span>
<span class="o">)</span> <span class="o">{</span> <span class="o">}</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<div class="language-java highlighter-rouge">
<div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre></td>
<td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">recordDTO</span><span class="o">()</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="n">cb</span> <span class="o">=</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">getCriteriaBuilder</span><span class="o">();</span>
    <span class="kt">var</span> <span class="n">cq</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="nc">OrderRecord</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="kt">var</span> <span class="n">root</span> <span class="o">=</span> <span class="n">cq</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

    <span class="n">cq</span><span class="o">.</span><span class="na">select</span><span class="o">(</span>
            <span class="n">cb</span><span class="o">.</span><span class="na">construct</span><span class="o">(</span>
                <span class="nc">OrderRecord</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
                <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Order_</span><span class="o">.</span><span class="na">id</span><span class="o">),</span>
                <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Order_</span><span class="o">.</span><span class="na">status</span><span class="o">),</span>
                <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Order_</span><span class="o">.</span><span class="na">fromAddress</span><span class="o">),</span>
                <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Order_</span><span class="o">.</span><span class="na">fromName</span><span class="o">),</span>
                <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Order_</span><span class="o">.</span><span class="na">fromPhoneNumber</span><span class="o">),</span>
                <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Order_</span><span class="o">.</span><span class="na">toAddress</span><span class="o">),</span>
                <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Order_</span><span class="o">.</span><span class="na">toName</span><span class="o">),</span>
                <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Order_</span><span class="o">.</span><span class="na">toPhoneNumber</span><span class="o">),</span>
                <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Order_</span><span class="o">.</span><span class="na">itemName</span><span class="o">),</span>
                <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Order_</span><span class="o">.</span><span class="na">itemPrice</span><span class="o">),</span>
                <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Order_</span><span class="o">.</span><span class="na">createdDateTime</span><span class="o">)</span>
            <span class="o">)</span>
    <span class="o">);</span>

    <span class="n">cq</span><span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">cb</span><span class="o">.</span><span class="na">notEqual</span><span class="o">(</span><span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Order_</span><span class="o">.</span><span class="na">status</span><span class="o">),</span> <span class="nc">OrderStatus</span><span class="o">.</span><span class="na">FAILED</span><span class="o">));</span>

    <span class="kt">var</span> <span class="n">q</span> <span class="o">=</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">cq</span><span class="o">);</span>
    <span class="kt">var</span> <span class="n">list</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
<span class="o">}</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<h2 id="임베디드-객체로-사용하기">
<span class="mr-2">임베디드 객체로 사용하기</span><a href="#%EC%9E%84%EB%B2%A0%EB%94%94%EB%93%9C-%EA%B0%9D%EC%B2%B4%EB%A1%9C-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h2>
<h3 id="hibernate--60">
<span class="mr-2">Hibernate &lt; 6.0</span><a href="#hibernate--60" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>Hiberante 6.0 이전 버전에서는 <code class="language-plaintext highlighter-rouge">record</code> 객체를 임베디드 객체로 사용할 수 없습니다. 이유는 위의 <code class="language-plaintext highlighter-rouge">record</code> 객체를 entity로 사용할 수 없는 이유와 같습니다.</p>
<h3 id="hibernate--60-1">
<span class="mr-2">Hibernate &gt;= 6.0</span><a href="#hibernate--60-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>Hibernate는 6 버전에서 <code class="language-plaintext highlighter-rouge">EmbeddableInstantiator</code> 기능을 소개하였습니다. 이 기능을 통해 enbeddable 객체를 보다 유연하게 인스턴스화 할수 있게 되었습니다. 이에대한 사이드 이펙트로 <code class="language-plaintext highlighter-rouge">record</code> 객체를 입데디드 객체로 사용할 수 있게 되었습니다.</p>
<div class="language-java highlighter-rouge">
<div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td>
<td class="rouge-code"><pre><span class="nd">@Entity</span>
<span class="nd">@Table</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"order_new"</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Order</span> <span class="o">{</span>
    <span class="o">...</span>
    
    <span class="nd">@Embedded</span>
    <span class="nc">ShippingInfo</span> <span class="n">fromInfo</span><span class="o">;</span>

    <span class="nd">@Embedded</span>
    <span class="nc">ShippingInfo</span> <span class="n">toInfo</span><span class="o">;</span>
    
    <span class="o">...</span>
<span class="o">}</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<div class="language-java highlighter-rouge">
<div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td>
<td class="rouge-code"><pre><span class="nd">@Embeddable</span>
<span class="kd">public</span> <span class="kd">record</span> <span class="nf">ShippingInfo</span><span class="o">(</span>
        <span class="nc">String</span> <span class="n">name</span><span class="o">,</span>
        <span class="nc">String</span> <span class="n">address</span><span class="o">,</span>
        <span class="nc">String</span> <span class="n">number</span>
<span class="o">)</span> <span class="o">{</span> <span class="o">}</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<p><code class="language-plaintext highlighter-rouge">Order</code> 엔티티에 <code class="language-plaintext highlighter-rouge">fromInfo</code>와 <code class="language-plaintext highlighter-rouge">toInfo</code> 라는 배송지 정보를 임베디드 객체로써 선언하였습니다.</p>
<blockquote><p><img class="emoji" title=":warning:" alt=":warning:" src="https://github.githubassets.com/images/icons/emoji/unicode/26a0.png" height="20" width="20"> 위 예제가 동작하려면 네이밍 전략이 <code class="language-plaintext highlighter-rouge">ImplicitNamingStrategyComponentPathImpl</code> 이어야 합니다. (&lt;property name=”hibernate.implicit_naming_strategy” value=”org.hibernate.boot.model.naming.ImplicitNamingStrategyComponentPathImpl” /&gt;)</p></blockquote>
<p><code class="language-plaintext highlighter-rouge">ShippingInfo</code> 객체를 임베디드 객체로써 사용하기 위해 이를 하이버네이트에 알려야 합니다. 이를 위해 <code class="language-plaintext highlighter-rouge">EmbeddableInstatiator</code>을 커스텀 하겠습니다.</p>
<div class="language-java highlighter-rouge">
<div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td>
<td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ShippingInfoInstantiator</span> <span class="kd">implements</span> <span class="nc">EmbeddableInstantiator</span> <span class="o">{</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="nc">Object</span> <span class="nf">instantiate</span><span class="o">(</span><span class="nc">ValueAccess</span> <span class="n">valueAccess</span><span class="o">,</span> <span class="nc">SessionFactoryImplementor</span> <span class="n">sessionFactory</span><span class="o">)</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="n">name</span> <span class="o">=</span> <span class="n">valueAccess</span><span class="o">.</span><span class="na">getValue</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="kt">var</span> <span class="n">address</span> <span class="o">=</span> <span class="n">valueAccess</span><span class="o">.</span><span class="na">getValue</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
        <span class="kt">var</span> <span class="n">street</span> <span class="o">=</span> <span class="n">valueAccess</span><span class="o">.</span><span class="na">getValue</span><span class="o">(</span><span class="mi">2</span><span class="o">,</span> <span class="nc">String</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

        <span class="k">return</span> <span class="k">new</span> <span class="nf">ShippingInfo</span><span class="o">(</span><span class="n">name</span><span class="o">,</span> <span class="n">address</span><span class="o">,</span> <span class="n">street</span><span class="o">);</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isInstance</span><span class="o">(</span><span class="nc">Object</span> <span class="n">object</span><span class="o">,</span> <span class="nc">SessionFactoryImplementor</span> <span class="n">sessionFactory</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">object</span> <span class="k">instanceof</span> <span class="nc">ShippingInfo</span><span class="o">;</span>
    <span class="o">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isSameClass</span><span class="o">(</span><span class="nc">Object</span> <span class="n">object</span><span class="o">,</span> <span class="nc">SessionFactoryImplementor</span> <span class="n">sessionFactory</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">return</span> <span class="n">object</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="nc">ShippingInfo</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<p>위 간단한 클래스에서 가장 중요한 것은 <code class="language-plaintext highlighter-rouge">instantiate</code> 메소드 입니다. 하이버네이트는 객체의 모든 필드 정보를 알파벳 순서로 담고 있는 <code class="language-plaintext highlighter-rouge">ValueAccess</code> 객체를 호출합니다. <code class="language-plaintext highlighter-rouge">ValudeAccess</code>객체에 인덱스로 접근하여 값을 원하는 유형으로 캐스팅 할 수 있습니다. 객체 인스턴스화에 필요한 모든 매개 변수를 추출한 후 마지막에 모든 매개 변수를 담고 있는 생성자를 생성하기 때문에 record를 임베디드 객체로써 사용할 수 있게 되는 것입니다.</p>
<div class="language-java highlighter-rouge">
<div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td>
<td class="rouge-code"><pre><span class="nd">@Embeddable</span>
<span class="nd">@EmbeddableInstantiator</span><span class="o">(</span><span class="nc">ShippingInfoInstantiator</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">record</span> <span class="nf">ShippingInfo</span><span class="o">(</span>
        <span class="nc">String</span> <span class="n">name</span><span class="o">,</span>
        <span class="nc">String</span> <span class="n">address</span><span class="o">,</span>
        <span class="nc">String</span> <span class="n">number</span>
<span class="o">)</span> <span class="o">{</span> <span class="o">}</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<p>위 코드처럼 <code class="language-plaintext highlighter-rouge">@EmbeddableInstantiator</code> 어노테이션을 통해 커스텀한 <code class="language-plaintext highlighter-rouge">EmbeddableInstatiator</code> 클래스를 지정하기만 하면 끝입니다.</p>
<p>이제 이 <code class="language-plaintext highlighter-rouge">record</code> 임베디드 객체가 잘 동작하는지 조회해 보도록 하겠습니다.</p>
<div class="language-java highlighter-rouge">
<div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td>
<td class="rouge-code"><pre><span class="kd">public</span> <span class="kd">record</span> <span class="nf">OrderRecord</span><span class="o">(</span>
        <span class="nc">String</span> <span class="n">id</span><span class="o">,</span>
        <span class="nc">OrderStatus</span> <span class="n">status</span><span class="o">,</span>
        <span class="nc">ShippingInfo</span> <span class="n">fromShippingInfo</span><span class="o">,</span>
        <span class="nc">ShippingInfo</span> <span class="n">toShippingInfo</span><span class="o">,</span>
        <span class="nc">String</span> <span class="n">itemName</span><span class="o">,</span>
        <span class="kt">int</span> <span class="n">itemPrice</span><span class="o">,</span>
        <span class="nc">LocalDateTime</span> <span class="n">createdDateTime</span>
<span class="o">)</span> <span class="o">{</span> <span class="o">}</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<p>결과를 반환받기 위한 dto 객체입니다.</p>
<div class="language-java highlighter-rouge">
<div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre></td>
<td class="rouge-code"><pre><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">recordDTO</span><span class="o">()</span> <span class="o">{</span>
    <span class="kt">var</span> <span class="n">cb</span> <span class="o">=</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">getCriteriaBuilder</span><span class="o">();</span>
    <span class="kt">var</span> <span class="n">cq</span> <span class="o">=</span> <span class="n">cb</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="nc">OrderRecord</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="kt">var</span> <span class="n">root</span> <span class="o">=</span> <span class="n">cq</span><span class="o">.</span><span class="na">from</span><span class="o">(</span><span class="nc">Order</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>

    <span class="n">cq</span><span class="o">.</span><span class="na">select</span><span class="o">(</span>
            <span class="n">cb</span><span class="o">.</span><span class="na">construct</span><span class="o">(</span>
                <span class="nc">OrderRecord</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
                <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Order_</span><span class="o">.</span><span class="na">id</span><span class="o">),</span>
                <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Order_</span><span class="o">.</span><span class="na">status</span><span class="o">),</span>
                <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fromInfo"</span><span class="o">),</span>
                <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"toInfo"</span><span class="o">),</span>
                <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Order_</span><span class="o">.</span><span class="na">itemName</span><span class="o">),</span>
                <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Order_</span><span class="o">.</span><span class="na">itemPrice</span><span class="o">),</span>
                <span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">Order_</span><span class="o">.</span><span class="na">createdDateTime</span><span class="o">)</span>
            <span class="o">)</span>
    <span class="o">);</span>

    <span class="n">cq</span><span class="o">.</span><span class="na">where</span><span class="o">(</span><span class="n">cb</span><span class="o">.</span><span class="na">like</span><span class="o">(</span><span class="n">root</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">"fromInfo"</span><span class="o">).</span><span class="na">get</span><span class="o">(</span><span class="s">"name"</span><span class="o">),</span> <span class="s">"%김%"</span><span class="o">));</span>

    <span class="kt">var</span> <span class="n">q</span> <span class="o">=</span> <span class="n">entityManager</span><span class="o">.</span><span class="na">createQuery</span><span class="o">(</span><span class="n">cq</span><span class="o">);</span>
    <span class="kt">var</span> <span class="n">list</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="na">getResultList</span><span class="o">();</span>
<span class="o">}</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<p>테스트 코드입니다. record 객체에는 setter 메소드를 작성할 수 없어 <code class="language-plaintext highlighter-rouge">jpamodelgen</code> 프로세서가 접근할 수 없습니다. 따라서 부득이하게 string 형태로 임베디드 객체에 접근하였습니다.</p>
<div class="language-sql highlighter-rouge">
<div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td>
<td class="rouge-code"><pre><span class="k">select</span>
        <span class="n">o1_0</span><span class="p">.</span><span class="n">id</span><span class="p">,</span>
        <span class="n">o1_0</span><span class="p">.</span><span class="n">status</span><span class="p">,</span>
        <span class="n">o1_0</span><span class="p">.</span><span class="n">fromInfo_address</span><span class="p">,</span>
        <span class="n">o1_0</span><span class="p">.</span><span class="n">fromInfo_name</span><span class="p">,</span>
        <span class="n">o1_0</span><span class="p">.</span><span class="n">fromInfo_number</span><span class="p">,</span>
        <span class="n">o1_0</span><span class="p">.</span><span class="n">toInfo_address</span><span class="p">,</span>
        <span class="n">o1_0</span><span class="p">.</span><span class="n">toInfo_name</span><span class="p">,</span>
        <span class="n">o1_0</span><span class="p">.</span><span class="n">toInfo_number</span><span class="p">,</span>
        <span class="n">o1_0</span><span class="p">.</span><span class="n">itemName</span><span class="p">,</span>
        <span class="n">o1_0</span><span class="p">.</span><span class="n">itemPrice</span><span class="p">,</span>
        <span class="n">o1_0</span><span class="p">.</span><span class="n">createdDateTime</span> 
    <span class="k">from</span>
        <span class="n">order_new</span> <span class="n">o1_0</span> 
    <span class="k">where</span>
        <span class="n">o1_0</span><span class="p">.</span><span class="n">fromInfo_name</span> <span class="k">like</span> <span class="o">?</span> <span class="k">escape</span> <span class="s1">''</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<p>정상적으로 sql문이 생성되었음을 확인할 수 있습니다.</p>
<h3 id="hibernate--62">
<span class="mr-2">Hibernate &gt;= 6.2</span><a href="#hibernate--62" class="anchor text-muted"><i class="fas fa-hashtag"></i></a>
</h3>
<p>Hibernate 6.2 버전부터는 커스텀 <code class="language-plaintext highlighter-rouge">EmbeddableInstatiator</code> 클래스조차 필요 없게 되었습니다. <code class="language-plaintext highlighter-rouge">record</code> 객체에 <code class="language-plaintext highlighter-rouge">@Embeddable</code> 객체를 붙이는 것만으로도 record 객체를 임베디드 객체로 사용할 수 있습니다.</p>
<div class="language-java highlighter-rouge">
<div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button>
</div>
<div class="highlight"><code><table class="rouge-table"><tbody><tr>
<td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td>
<td class="rouge-code"><pre><span class="nd">@Embeddable</span>
<span class="kd">public</span> <span class="kd">record</span> <span class="nf">ShippingInfo</span><span class="o">(</span>
        <span class="nc">String</span> <span class="n">name</span><span class="o">,</span>
        <span class="nc">String</span> <span class="n">address</span><span class="o">,</span>
        <span class="nc">String</span> <span class="n">number</span>
<span class="o">)</span> <span class="o">{</span> <span class="o">}</span>
</pre></td>
</tr></tbody></table></code></div>
</div>
<p>물론 기존과 같이 커스텀 <code class="language-plaintext highlighter-rouge">EmbeddableInstatiator</code> 를 만들어 지정할 수도 있습니다.</p>
</div>
<div class="post-tail-wrapper text-muted">
<div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href="/categories/jpa/">JPA</a>
</div>
<div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/jpa/" class="post-tag no-text-decoration">JPA</a> <a href="/tags/hibernate/" class="post-tag no-text-decoration">Hibernate</a>
</div>
<div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2">
<div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div>
<div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=JPA+%EC%97%90%EC%84%9C+Java+Record+%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0+-+keencho%27s+blog&amp;url=https%3A%2F%2Fkeencho.github.io%2Fposts%2Fuse-java-record-in-jpa-hibernate%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=JPA+%EC%97%90%EC%84%9C+Java+Record+%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0+-+keencho%27s+blog&amp;u=https%3A%2F%2Fkeencho.github.io%2Fposts%2Fuse-java-record-in-jpa-hibernate%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fkeencho.github.io%2Fposts%2Fuse-java-record-in-jpa-hibernate%2F&amp;text=JPA+%EC%97%90%EC%84%9C+Java+Record+%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0+-+keencho%27s+blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span>
</div>
</div>
</div>
</div></div>
<div id="panel-wrapper" class="col-xl-3 pl-2 text-muted">
<div class="access">
<div id="access-lastmod" class="post">
<div class="panel-heading">Recently Updated</div>
<ul class="post-content pl-0 pb-1 ml-1 mt-2">
<li><a href="/posts/jpa-flush/">JPA &amp; Hibernate Flush Mode</a></li>
<li><a href="/posts/aws-cicd-1/">AWS를 사용해 무중단 배포 자동화 환경 구축하기 - 1. 개요</a></li>
<li><a href="/posts/terraform-aws-infra-6/">Terraform으로 AWS 무중단 배포 인프라 구성하기 - 6. 운영환경 (백엔드)</a></li>
<li><a href="/posts/aapt2-arm/">Arm 아키텍처에서 AAPT2 빌드 도구 사용하기</a></li>
<li><a href="/posts/terraform-aws-infra-1/">Terraform으로 AWS 무중단 배포 인프라 구성하기 - 1. 개요</a></li>
</ul>
</div>
<div id="access-tags">
<div class="panel-heading">Trending Tags</div>
<div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/design-pattern/">Design Pattern</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/hibernate/">Hibernate</a> <a class="post-tag" href="/tags/ecs/">ECS</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/querydsl/">QueryDSL</a> <a class="post-tag" href="/tags/react/">React</a>
</div>
</div>
</div>
<script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5">
<div class="panel-heading pl-3 pt-2 mb-2">Contents</div>
<nav id="toc" data-toggle="toc"></nav>
</div>
</div>
</div>
<div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4">
<div id="related-posts" class="mt-5 mb-2 mb-sm-4">
<h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3>
<div class="card-deck mb-4">
<div class="card"> <a href="/posts/hibernate-where/"><div class="card-body"> <em class="small" data-ts="1653520320" data-df="ll"> May 26, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hibernate @Where</h3>
<div class="text-muted small"><p> Hibernate @Where @Where 란? 떄때로 커스텀한 SQL을 이용해 엔티티 혹은 컬렉션을 필터링하고 싶은 경우가 있습니다. 이 경우 Hibernate 에서 제공하는 어노테이션중 @Where 이라는 어노테이션을 사용해 쉽게 필터링 할 수 있습니다. @Target({TYPE, METHOD, FIELD}) @Retention(RUNTIME)...</p></div>
</div></a>
</div>
<div class="card"> <a href="/posts/hibernate-cross-join/"><div class="card-body"> <em class="small" data-ts="1658315520" data-df="ll"> Jul 20, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hibernate, JPA 에서 발생하는 Cross Join 문제 해결하기</h3>
<div class="text-muted small"><p> Hibernate, JPA 에서 발생하는 Cross Join 문제 해결하기 개요 평화롭게 코딩하던 어느날, 쿼리 결과가 의도한대로 리턴되지 않는 문제가 발생하였습니다. 쿼리에 문제가 있나 싶어 자세히 살펴봤지만 (queryDSL을 사용중이었습니다.) 자바 코드상의 문제는 찾을 수 없었습니다. 데이터베이스에 날라가는 sql문을 보고 나서야 문제를 찾...</p></div>
</div></a>
</div>
<div class="card"> <a href="/posts/dirty-checking/"><div class="card-body"> <em class="small" data-ts="1665871920" data-df="ll"> Oct 16, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Dirty Checking</h3>
<div class="text-muted small"><p> Dirty Checking 1. 개요 하이버네이트 / jpa를 사용하다보면 이미 저장된 엔티티의 경우 jpa repository의 save() 메소드를 호출하지 않아도 한 트랜잭션이 종료되면 엔티티의 변경점이 자동으로 업데이트되는 현상을 발견할 수 있습니다. var delivery = deliveryRepository.findById(1L).orE...</p></div>
</div></a>
</div>
</div>
</div>
<div class="post-navigation d-flex justify-content-between"> <a href="/posts/hibernate-postgresql-jsonb/" class="btn btn-outline-primary" prompt="Older"><p>Hibernate 에서 PostgreSQL JSONB 다루기</p></a> <a href="/posts/web-workers/" class="btn btn-outline-primary" prompt="Newer"><p>Web Worker</p></a>
</div>
</div></div>
<footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0">
<div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/keencho">keencho</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div>
<div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div>
</div></footer>
</div>
<div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content">
<div id="search-hints"><div id="access-tags">
<div class="panel-heading">Trending Tags</div>
<div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">AWS</a> <a class="post-tag" href="/tags/java/">Java</a> <a class="post-tag" href="/tags/jpa/">JPA</a> <a class="post-tag" href="/tags/design-pattern/">Design Pattern</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/hibernate/">Hibernate</a> <a class="post-tag" href="/tags/ecs/">ECS</a> <a class="post-tag" href="/tags/spring/">Spring</a> <a class="post-tag" href="/tags/querydsl/">QueryDSL</a> <a class="post-tag" href="/tags/react/">React</a>
</div>
</div></div>
<div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
</div></div>
</div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false">
<div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">×</span> </button>
</div>
<div class="toast-body text-center pt-0">
<p class="pl-2 pr-2 mb-3">A new version of content is available.</p>
<button type="button" class="btn btn-primary" aria-label="Update"> Update </button>
</div>
</div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
